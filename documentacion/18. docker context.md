## Docker context
Un Docker context es una configuración guardada que te permite cambiar fácilmente entre diferentes entornos (local, remoto, Docker Desktop, servidores, etc.).

Son como “perfiles” o “conexiones” que te permiten hablar con diferentes motores de Docker (daemons).


### Listar contextos
```bash
docker context ls 
```


### Crear un contexto
```bash
docker context create docker-prod --docker host=unix:///var/run/docker-prod.sock
```


### Cambiar de contexto
```bash
docker use docker-prod
```
Ahora el comando docker tendrá efecto sobre este daemon


## Crear otro contexto (nodo)
Para crear otro demonio docker y trabajar con 2 host o nodos en la misma maquina vamos a crear ese otro docker.

### Creamos una red bridge para ese docker
```bash
docker network create red2
```

En las redes de docker se habrá creado la red, y en nuestras interface de red tambien.
```bash
docker network ls
```
```bash
nmcli
```
Cogemos de nmcli la red que empieza por **br-** y hace match con el id de la red creada en docker: `br-809c0c9f5a35`

Lanzamos a mano el demonio para verificar que funciona y para que se creen todas las rutas correspondientes.
```bash
dockerd \
    -H unix:///var/run/docker-prod.sock \
    -p /var/run/docker-prod.pid \
    --iptables=false \
    --ip-masq=false \
    --bridge=br-809c0c9f5a35 \
    --data-root=/var/lib/docker-prod \
    --exec-root=/var/run/dokcer-prod
```
Crear un servicio llamado docker-prod que lance ese segundo dockerd con sus propios sockets, rutas, y configuración de red.
```bash
vim /etc/systemd/system/docker-prod.service
```
```
[Unit]
Description=Docker Prod Daemon
After=network.target

[Service]
ExecStart=/usr/bin/dockerd \
  -H unix:///var/run/docker-prod.sock \
  -p /var/run/docker-prod.pid \
  --iptables=false \
  --ip-masq=false \
  --bridge=br-809c0c9f5a35 \
  --data-root=/var/lib/docker-prod \
  --exec-root=/var/run/docker-prod

ExecStop=/bin/kill -s SIGTERM $MAINPID
Restart=always
LimitNOFILE=1048576
LimitNPROC=infinity
LimitCORE=infinity
TasksMax=infinity

[Install]
WantedBy=multi-user.target

systemctl daemon-reexec
systemctl daemon-reload
systemctl enable docker-prod
systemctl start docker-prod
```


### Conectarse desde una maquina cliente
En una maquina cliente tengo que tener `docker-cli` instalado

Creo un contexto con los datos de conexion 
```bash
docker context create docker-prod --docker "host=ssh://root@192.168.1.110:22"
```

Cambio de conexto 
```bash
docker context use docker-prod
```
Ahora puedo ejecutar comandos de manera remota sobre ese docker de ese host remoto
```bash
docker ps -a
```